require_relative "../vpc_stack/subnets"

module <%= name %>Stack
  module Parent
    extend ActiveSupport::Concern

    included do
      resource :vpc_stack,
               type: "AWS::CloudFormation::Stack" do |r|
        r.property(:template_u_r_l) { "vpcstack" }
        r.property(:timeout_in_minutes) { "5" }
      end

      resource :ecs_stack,
               type: "AWS::CloudFormation::Stack" do |r|
        r.depends_on %w(VpcStack)
        r.property(:template_u_r_l) { "ecsstack" }
        r.property(:parameters) do
          {
              "Vpc": "VpcStack".ref("Outputs.<%= name %>Vpc")
          }
        end
      end
    end
  end
end
