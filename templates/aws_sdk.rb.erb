def create_bucket_if_not_exists(aws_region, artifact_bucket)
  s3 = Aws::S3::Resource.new(region: aws_region)
  begin
    s3.create_bucket(bucket: artifact_bucket)
  rescue => exception
    raise exception unless exception.class == Aws::S3::Errors::BucketAlreadyOwnedByYou
  end
  s3
end

def set_aws_credentials(region, access_key_id, secret_access_key)
  Aws.config.update(
    region: region,
    credentials: Aws::Credentials.new(
      access_key_id, secret_access_key
    )
  )
end
